from pathlib import Path
import torch


class Config:
    LOG_NAME = 'log'
    # DATA_DIR = Path('../data')  # local
    DATA_DIR = Path('/kaggle/input/isic-2024-challenge')  # kaggle
    OUTPUT_DIR = Path('./model')
    IS_TRAIN = False
    IS_DEBUG = False
    PATTERN = 1  # train param
    SEED = 42
    ERR = 1e-5
    NUM_FEATURE_COLS = [
        'age_approx',
        'clin_size_long_diam_mm',
        'tbp_lv_A',
        'tbp_lv_Aext',
        'tbp_lv_B',
        'tbp_lv_Bext',
        'tbp_lv_C',
        'tbp_lv_Cext',
        'tbp_lv_H',
        'tbp_lv_Hext',
        'tbp_lv_L',
        'tbp_lv_Lext',
        'tbp_lv_areaMM2',
        'tbp_lv_area_perim_ratio',
        'tbp_lv_color_std_mean',
        'tbp_lv_deltaA',
        'tbp_lv_deltaB',
        'tbp_lv_deltaL',
        'tbp_lv_deltaLB',
        'tbp_lv_deltaLBnorm',
        'tbp_lv_eccentricity',
        'tbp_lv_minorAxisMM',
        'tbp_lv_norm_border',
        'tbp_lv_perimeterMM',
        'tbp_lv_radial_color_std_max',
        'tbp_lv_stdL',
        'tbp_lv_stdLExt',
        'tbp_lv_x',
        'tbp_lv_y',
        'tbp_lv_z',
    ]
    CAT_FEATURE_COLS = [
        'tbp_tile_type',
        'tbp_lv_location',
        'tbp_lv_location_simple',
        'attribution',
        'combined_anatomical_site',
    ]
    DEVICE = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    IMAGE_SIZE = 128
    N_FOLD = 5
    N_TRAIN_SET = 10
    BS = 64
    N_EPOCH = 20
    N_WORKER = 24
    LGB_PARAMS = {
        'objective': 'binary',
        'verbosity': -1,
        'boosting_type': 'gbdt',
        'lambda_l1': 0.08758718919397321, 
        'lambda_l2': 0.0039689175176025465, 
        'learning_rate': 0.03231007103195577, 
        'max_depth': 4,
        'num_leaves': 103,
        'colsample_bytree': 0.8329551585827726, 
        'colsample_bynode': 0.4025961355653304, 
        'bagging_fraction': 0.7738954452473223, 
        'bagging_freq': 4,
        'min_data_in_leaf': 85,
        'scale_pos_weight': 2.7984184778875543,
        'num_threads': 12,
    }
    XGB_PARAMS = {
        'objective': 'binary:logistic',
        # 'enable_categorical': True,
        'tree_method': 'hist',
        'learning_rate': 0.08501257473292347, 
        'lambda': 8.879624125465703, 
        'alpha': 0.6779926606782505, 
        'max_depth': 6, 
        'subsample': 0.6012681388711075, 
        'colsample_bytree': 0.8437772277074493, 
        'colsample_bylevel': 0.5476090898823716, 
        'colsample_bynode': 0.9928601203635129, 
        'scale_pos_weight': 3.29440313334688,
        'nthread': 12,
    }
    CATB_PARAMS = {
        'loss_function': 'Logloss',
        'iterations': 350,
        'verbose': False,
        'max_depth': 7, 
        'learning_rate': 0.06936242010150652, 
        'scale_pos_weight': 2.6149345838209532, 
        'l2_leaf_reg': 6.216113851699493, 
        'subsample': 0.6249261779711819, 
        'min_data_in_leaf': 24,
        'thread_count': 12,
    }
    MODEL_SEEDS = [42]
    FEATURE_COLS_P1 = [
        'age_approx',
        'clin_size_long_diam_mm',
        'tbp_lv_A',
        'tbp_lv_Aext',
        'tbp_lv_B',
        'tbp_lv_Bext',
        'tbp_lv_C',
        'tbp_lv_Cext',
        'tbp_lv_H',
        'tbp_lv_Hext',
        'tbp_lv_L',
        'tbp_lv_Lext',
        'tbp_lv_areaMM2',
        'tbp_lv_area_perim_ratio',
        'tbp_lv_color_std_mean',
        'tbp_lv_deltaA',
        'tbp_lv_deltaB',
        'tbp_lv_deltaL',
        'tbp_lv_deltaLB',
        'tbp_lv_deltaLBnorm',
        'tbp_lv_eccentricity',
        'tbp_lv_minorAxisMM',
        'tbp_lv_norm_border',
        'tbp_lv_perimeterMM',
        'tbp_lv_radial_color_std_max',
        'tbp_lv_stdL',
        'tbp_lv_stdLExt',
        'tbp_lv_x',
        'tbp_lv_y',
        'tbp_lv_z',
        'lesion_size_ratio',
        'lesion_shape_index',
        'hue_contrast',
        'luminance_contrast',
        'lesion_color_difference',
        'border_complexity',
        'color_uniformity',
        'position_distance_3d',
        'perimeter_to_area_ratio',
        'area_to_perimeter_ratio',
        'lesion_visibility_score',
        'symmetry_border_consistency',
        'consistency_symmetry_border',
        'color_consistency',
        'consistency_color',
        'size_age_interaction',
        'hue_color_std_interaction',
        'lesion_severity_index',
        'shape_complexity_index',
        'color_contrast_index',
        'log_lesion_area',
        'normalized_lesion_size',
        'mean_hue_difference',
        'std_dev_contrast',
        'color_shape_composite_index',
        'lesion_orientation_3d',
        'overall_color_difference',
        'symmetry_perimeter_interaction',
        'comprehensive_lesion_index',
        'color_variance_ratio',
        'border_color_interaction',
        'border_color_interaction_2',
        'size_color_contrast_ratio',
        'age_normalized_nevi_confidence_2',
        'color_asymmetry_index',
        'volume_approximation_3d',
        'color_range',
        'shape_color_consistency',
        'border_length_ratio',
        'age_size_symmetry_index',
        'index_age_size_symmetry',
        'area_age_ratio',
        'symmetry_eccentricity_interaction',
        'border_complexity_normalized',
        'color_variation_index',
        'lesion_flatness',
        'relative_hue_difference',
        'area_diameter_ratio',
        'color_geometric_mean',
        'tbp_lv_norm_color_per_long_diam',
        'norm_L',
        'norm_A',
        'norm_B',
        'area_ratio',
        'weighted_area_ratio',
        'clin_size_long_diam_mm_per_age',
        'age_approx_patient_norm',
        'clin_size_long_diam_mm_patient_norm',
        'tbp_lv_A_patient_norm',
        'tbp_lv_Aext_patient_norm',
        'tbp_lv_B_patient_norm',
        'tbp_lv_Bext_patient_norm',
        'tbp_lv_C_patient_norm',
        'tbp_lv_Cext_patient_norm',
        'tbp_lv_H_patient_norm',
        'tbp_lv_Hext_patient_norm',
        'tbp_lv_L_patient_norm',
        'tbp_lv_Lext_patient_norm',
        'tbp_lv_areaMM2_patient_norm',
        'tbp_lv_area_perim_ratio_patient_norm',
        'tbp_lv_color_std_mean_patient_norm',
        'tbp_lv_deltaA_patient_norm',
        'tbp_lv_deltaB_patient_norm',
        'tbp_lv_deltaL_patient_norm',
        'tbp_lv_deltaLB_patient_norm',
        'tbp_lv_deltaLBnorm_patient_norm',
        'tbp_lv_eccentricity_patient_norm',
        'tbp_lv_minorAxisMM_patient_norm',
        'tbp_lv_norm_border_patient_norm',
        'tbp_lv_perimeterMM_patient_norm',
        'tbp_lv_radial_color_std_max_patient_norm',
        'tbp_lv_stdL_patient_norm',
        'tbp_lv_stdLExt_patient_norm',
        'tbp_lv_x_patient_norm',
        'tbp_lv_y_patient_norm',
        'tbp_lv_z_patient_norm',
        'age_approx_patient_ttype_norm',
        'clin_size_long_diam_mm_patient_ttype_norm',
        'tbp_lv_A_patient_ttype_norm',
        'tbp_lv_Aext_patient_ttype_norm',
        'tbp_lv_B_patient_ttype_norm',
        'tbp_lv_Bext_patient_ttype_norm',
        'tbp_lv_C_patient_ttype_norm',
        'tbp_lv_Cext_patient_ttype_norm',
        'tbp_lv_H_patient_ttype_norm',
        'tbp_lv_Hext_patient_ttype_norm',
        'tbp_lv_L_patient_ttype_norm',
        'tbp_lv_Lext_patient_ttype_norm',
        'tbp_lv_areaMM2_patient_ttype_norm',
        'tbp_lv_area_perim_ratio_patient_ttype_norm',
        'tbp_lv_color_std_mean_patient_ttype_norm',
        'tbp_lv_deltaA_patient_ttype_norm',
        'tbp_lv_deltaB_patient_ttype_norm',
        'tbp_lv_deltaL_patient_ttype_norm',
        'tbp_lv_deltaLB_patient_ttype_norm',
        'tbp_lv_deltaLBnorm_patient_ttype_norm',
        'tbp_lv_eccentricity_patient_ttype_norm',
        'tbp_lv_minorAxisMM_patient_ttype_norm',
        'tbp_lv_norm_border_patient_ttype_norm',
        'tbp_lv_perimeterMM_patient_ttype_norm',
        'tbp_lv_radial_color_std_max_patient_ttype_norm',
        'tbp_lv_stdL_patient_ttype_norm',
        'tbp_lv_stdLExt_patient_ttype_norm',
        'tbp_lv_x_patient_ttype_norm',
        'tbp_lv_y_patient_ttype_norm',
        'tbp_lv_z_patient_ttype_norm',
        'age_approx_patient_loc_norm',
        'clin_size_long_diam_mm_patient_loc_norm',
        'tbp_lv_A_patient_loc_norm',
        'tbp_lv_Aext_patient_loc_norm',
        'tbp_lv_B_patient_loc_norm',
        'tbp_lv_Bext_patient_loc_norm',
        'tbp_lv_C_patient_loc_norm',
        'tbp_lv_Cext_patient_loc_norm',
        'tbp_lv_H_patient_loc_norm',
        'tbp_lv_Hext_patient_loc_norm',
        'tbp_lv_L_patient_loc_norm',
        'tbp_lv_Lext_patient_loc_norm',
        'tbp_lv_areaMM2_patient_loc_norm',
        'tbp_lv_area_perim_ratio_patient_loc_norm',
        'tbp_lv_color_std_mean_patient_loc_norm',
        'tbp_lv_deltaA_patient_loc_norm',
        'tbp_lv_deltaB_patient_loc_norm',
        'tbp_lv_deltaL_patient_loc_norm',
        'tbp_lv_deltaLB_patient_loc_norm',
        'tbp_lv_deltaLBnorm_patient_loc_norm',
        'tbp_lv_eccentricity_patient_loc_norm',
        'tbp_lv_minorAxisMM_patient_loc_norm',
        'tbp_lv_norm_border_patient_loc_norm',
        'tbp_lv_perimeterMM_patient_loc_norm',
        'tbp_lv_radial_color_std_max_patient_loc_norm',
        'tbp_lv_stdL_patient_loc_norm',
        'tbp_lv_stdLExt_patient_loc_norm',
        'tbp_lv_x_patient_loc_norm',
        'tbp_lv_y_patient_loc_norm',
        'tbp_lv_z_patient_loc_norm',
        'age_approx_patient_locsim_norm',
        'clin_size_long_diam_mm_patient_locsim_norm',
        'tbp_lv_A_patient_locsim_norm',
        'tbp_lv_Aext_patient_locsim_norm',
        'tbp_lv_B_patient_locsim_norm',
        'tbp_lv_Bext_patient_locsim_norm',
        'tbp_lv_C_patient_locsim_norm',
        'tbp_lv_Cext_patient_locsim_norm',
        'tbp_lv_H_patient_locsim_norm',
        'tbp_lv_Hext_patient_locsim_norm',
        'tbp_lv_L_patient_locsim_norm',
        'tbp_lv_Lext_patient_locsim_norm',
        'tbp_lv_areaMM2_patient_locsim_norm',
        'tbp_lv_area_perim_ratio_patient_locsim_norm',
        'tbp_lv_color_std_mean_patient_locsim_norm',
        'tbp_lv_deltaA_patient_locsim_norm',
        'tbp_lv_deltaB_patient_locsim_norm',
        'tbp_lv_deltaL_patient_locsim_norm',
        'tbp_lv_deltaLB_patient_locsim_norm',
        'tbp_lv_deltaLBnorm_patient_locsim_norm',
        'tbp_lv_eccentricity_patient_locsim_norm',
        'tbp_lv_minorAxisMM_patient_locsim_norm',
        'tbp_lv_norm_border_patient_locsim_norm',
        'tbp_lv_perimeterMM_patient_locsim_norm',
        'tbp_lv_radial_color_std_max_patient_locsim_norm',
        'tbp_lv_stdL_patient_locsim_norm',
        'tbp_lv_stdLExt_patient_locsim_norm',
        'tbp_lv_x_patient_locsim_norm',
        'tbp_lv_y_patient_locsim_norm',
        'tbp_lv_z_patient_locsim_norm',
        'age_approx_patient_attr_norm',
        'clin_size_long_diam_mm_patient_attr_norm',
        'tbp_lv_A_patient_attr_norm',
        'tbp_lv_Aext_patient_attr_norm',
        'tbp_lv_B_patient_attr_norm',
        'tbp_lv_Bext_patient_attr_norm',
        'tbp_lv_C_patient_attr_norm',
        'tbp_lv_Cext_patient_attr_norm',
        'tbp_lv_H_patient_attr_norm',
        'tbp_lv_Hext_patient_attr_norm',
        'tbp_lv_L_patient_attr_norm',
        'tbp_lv_Lext_patient_attr_norm',
        'tbp_lv_areaMM2_patient_attr_norm',
        'tbp_lv_area_perim_ratio_patient_attr_norm',
        'tbp_lv_color_std_mean_patient_attr_norm',
        'tbp_lv_deltaA_patient_attr_norm',
        'tbp_lv_deltaB_patient_attr_norm',
        'tbp_lv_deltaL_patient_attr_norm',
        'tbp_lv_deltaLB_patient_attr_norm',
        'tbp_lv_deltaLBnorm_patient_attr_norm',
        'tbp_lv_eccentricity_patient_attr_norm',
        'tbp_lv_minorAxisMM_patient_attr_norm',
        'tbp_lv_norm_border_patient_attr_norm',
        'tbp_lv_perimeterMM_patient_attr_norm',
        'tbp_lv_radial_color_std_max_patient_attr_norm',
        'tbp_lv_stdL_patient_attr_norm',
        'tbp_lv_stdLExt_patient_attr_norm',
        'tbp_lv_x_patient_attr_norm',
        'tbp_lv_y_patient_attr_norm',
        'tbp_lv_z_patient_attr_norm',
        'count_per_patient',
        'count_per_patient_ttype',
        'count_per_patient_loc',
        'count_per_patient_locsim',
        'count_per_patient_attr',
        'tbp_tile_type_3D__white',
        'tbp_tile_type_3D__XP',
        'tbp_lv_location_Right_Leg___Upper',
        'tbp_lv_location_Head___Neck',
        'tbp_lv_location_Torso_Back_Top_Third',
        'tbp_lv_location_Torso_Front_Top_Half',
        'tbp_lv_location_Right_Arm___Upper',
        'tbp_lv_location_Left_Leg___Upper',
        'tbp_lv_location_Torso_Front_Bottom_Half',
        'tbp_lv_location_Left_Arm___Upper',
        'tbp_lv_location_Right_Leg',
        'tbp_lv_location_Torso_Back_Middle_Third',
        'tbp_lv_location_Right_Arm___Lower',
        'tbp_lv_location_Right_Leg___Lower',
        'tbp_lv_location_Left_Leg___Lower',
        'tbp_lv_location_Left_Arm___Lower',
        'tbp_lv_location_Unknown',
        'tbp_lv_location_Left_Leg',
        'tbp_lv_location_Torso_Back_Bottom_Third',
        'tbp_lv_location_Left_Arm',
        'tbp_lv_location_Right_Arm',
        'tbp_lv_location_Torso_Front',
        'tbp_lv_location_Torso_Back',
        'tbp_lv_location_simple_Right_Leg',
        'tbp_lv_location_simple_Head___Neck',
        'tbp_lv_location_simple_Torso_Back',
        'tbp_lv_location_simple_Torso_Front',
        'tbp_lv_location_simple_Right_Arm',
        'tbp_lv_location_simple_Left_Leg',
        'tbp_lv_location_simple_Left_Arm',
        'tbp_lv_location_simple_Unknown',
        'attribution_Memorial_Sloan_Kettering_Cancer_Center',
        'attribution_ACEMID_MIA',
        'attribution_Department_of_Dermatology__Hospital_Clínic_de_Barcelona',
        'attribution_University_Hospital_of_Basel',
        'attribution_Frazer_Institute__The_University_of_Queensland__Dermatology_Research_Centre',
        'attribution_Department_of_Dermatology__University_of_Athens__Andreas_Syggros_Hospital_of_Skin_and_Venereal_Diseases__Alexander_Stratigos__Konstantinos_Liopyris',
        'attribution_ViDIR_Group__Department_of_Dermatology__Medical_University_of_Vienna',
        'combined_anatomical_site_lower_extremity_Right_Leg___Upper',
        'combined_anatomical_site_head_neck_Head___Neck',
        'combined_anatomical_site_posterior_torso_Torso_Back_Top_Third',
        'combined_anatomical_site_anterior_torso_Torso_Front_Top_Half',
        'combined_anatomical_site_upper_extremity_Right_Arm___Upper',
        'combined_anatomical_site_lower_extremity_Left_Leg___Upper',
        'combined_anatomical_site_anterior_torso_Torso_Front_Bottom_Half',
        'combined_anatomical_site_upper_extremity_Left_Arm___Upper',
        'combined_anatomical_site_lower_extremity_Right_Leg',
        'combined_anatomical_site_posterior_torso_Torso_Back_Middle_Third',
        'combined_anatomical_site_upper_extremity_Right_Arm___Lower',
        'combined_anatomical_site_lower_extremity_Right_Leg___Lower',
        'combined_anatomical_site_lower_extremity_Left_Leg___Lower',
        'combined_anatomical_site_upper_extremity_Left_Arm___Lower',
        'combined_anatomical_site__Unknown',
        'combined_anatomical_site_lower_extremity_Left_Leg',
        'combined_anatomical_site_posterior_torso_Torso_Back_Bottom_Third',
        'combined_anatomical_site_upper_extremity_Left_Arm',
        'combined_anatomical_site_upper_extremity_Right_Arm',
        'combined_anatomical_site_anterior_torso_Torso_Front',
        'combined_anatomical_site_posterior_torso_Torso_Back',
    ]
    FEATURE_COLS_P2 = [
        'age_approx',
        'clin_size_long_diam_mm',
        'tbp_lv_A',
        'tbp_lv_Aext',
        'tbp_lv_B',
        'tbp_lv_Bext',
        'tbp_lv_C',
        'tbp_lv_Cext',
        'tbp_lv_H',
        'tbp_lv_Hext',
        'tbp_lv_L',
        'tbp_lv_Lext',
        'tbp_lv_areaMM2',
        'tbp_lv_area_perim_ratio',
        'tbp_lv_color_std_mean',
        'tbp_lv_deltaA',
        'tbp_lv_deltaB',
        'tbp_lv_deltaL',
        'tbp_lv_deltaLB',
        'tbp_lv_deltaLBnorm',
        'tbp_lv_eccentricity',
        'tbp_lv_minorAxisMM',
        'tbp_lv_norm_border',
        'tbp_lv_perimeterMM',
        'tbp_lv_radial_color_std_max',
        'tbp_lv_stdL',
        'tbp_lv_stdLExt',
        'tbp_lv_x',
        'tbp_lv_y',
        'tbp_lv_z',
        'lesion_size_ratio',
        'lesion_shape_index',
        'hue_contrast',
        'luminance_contrast',
        'lesion_color_difference',
        'border_complexity',
        'color_uniformity',
        'position_distance_3d',
        'perimeter_to_area_ratio',
        'area_to_perimeter_ratio',
        'lesion_visibility_score',
        'symmetry_border_consistency',
        'consistency_symmetry_border',
        'color_consistency',
        'consistency_color',
        'size_age_interaction',
        'hue_color_std_interaction',
        'lesion_severity_index',
        'shape_complexity_index',
        'color_contrast_index',
        'log_lesion_area',
        'normalized_lesion_size',
        'mean_hue_difference',
        'std_dev_contrast',
        'color_shape_composite_index',
        'lesion_orientation_3d',
        'overall_color_difference',
        'symmetry_perimeter_interaction',
        'comprehensive_lesion_index',
        'color_variance_ratio',
        'border_color_interaction',
        'border_color_interaction_2',
        'size_color_contrast_ratio',
        'age_normalized_nevi_confidence_2',
        'color_asymmetry_index',
        'volume_approximation_3d',
        'color_range',
        'shape_color_consistency',
        'border_length_ratio',
        'age_size_symmetry_index',
        'index_age_size_symmetry',
        'area_age_ratio',
        'symmetry_eccentricity_interaction',
        'border_complexity_normalized',
        'color_variation_index',
        'lesion_flatness',
        'relative_hue_difference',
        'area_diameter_ratio',
        'color_geometric_mean',
        'age_approx_patient_norm',
        'clin_size_long_diam_mm_patient_norm',
        'tbp_lv_A_patient_norm',
        'tbp_lv_Aext_patient_norm',
        'tbp_lv_B_patient_norm',
        'tbp_lv_Bext_patient_norm',
        'tbp_lv_C_patient_norm',
        'tbp_lv_Cext_patient_norm',
        'tbp_lv_H_patient_norm',
        'tbp_lv_Hext_patient_norm',
        'tbp_lv_L_patient_norm',
        'tbp_lv_Lext_patient_norm',
        'tbp_lv_areaMM2_patient_norm',
        'tbp_lv_area_perim_ratio_patient_norm',
        'tbp_lv_color_std_mean_patient_norm',
        'tbp_lv_deltaA_patient_norm',
        'tbp_lv_deltaB_patient_norm',
        'tbp_lv_deltaL_patient_norm',
        'tbp_lv_deltaLB_patient_norm',
        'tbp_lv_deltaLBnorm_patient_norm',
        'tbp_lv_eccentricity_patient_norm',
        'tbp_lv_minorAxisMM_patient_norm',
        'tbp_lv_norm_border_patient_norm',
        'tbp_lv_perimeterMM_patient_norm',
        'tbp_lv_radial_color_std_max_patient_norm',
        'tbp_lv_stdL_patient_norm',
        'tbp_lv_stdLExt_patient_norm',
        'tbp_lv_x_patient_norm',
        'tbp_lv_y_patient_norm',
        'tbp_lv_z_patient_norm',
        'age_approx_patient_ttype_norm',
        'clin_size_long_diam_mm_patient_ttype_norm',
        'tbp_lv_A_patient_ttype_norm',
        'tbp_lv_Aext_patient_ttype_norm',
        'tbp_lv_B_patient_ttype_norm',
        'tbp_lv_Bext_patient_ttype_norm',
        'tbp_lv_C_patient_ttype_norm',
        'tbp_lv_Cext_patient_ttype_norm',
        'tbp_lv_H_patient_ttype_norm',
        'tbp_lv_Hext_patient_ttype_norm',
        'tbp_lv_L_patient_ttype_norm',
        'tbp_lv_Lext_patient_ttype_norm',
        'tbp_lv_areaMM2_patient_ttype_norm',
        'tbp_lv_area_perim_ratio_patient_ttype_norm',
        'tbp_lv_color_std_mean_patient_ttype_norm',
        'tbp_lv_deltaA_patient_ttype_norm',
        'tbp_lv_deltaB_patient_ttype_norm',
        'tbp_lv_deltaL_patient_ttype_norm',
        'tbp_lv_deltaLB_patient_ttype_norm',
        'tbp_lv_deltaLBnorm_patient_ttype_norm',
        'tbp_lv_eccentricity_patient_ttype_norm',
        'tbp_lv_minorAxisMM_patient_ttype_norm',
        'tbp_lv_norm_border_patient_ttype_norm',
        'tbp_lv_perimeterMM_patient_ttype_norm',
        'tbp_lv_radial_color_std_max_patient_ttype_norm',
        'tbp_lv_stdL_patient_ttype_norm',
        'tbp_lv_stdLExt_patient_ttype_norm',
        'tbp_lv_x_patient_ttype_norm',
        'tbp_lv_y_patient_ttype_norm',
        'tbp_lv_z_patient_ttype_norm',
        'age_approx_patient_loc_norm',
        'clin_size_long_diam_mm_patient_loc_norm',
        'tbp_lv_A_patient_loc_norm',
        'tbp_lv_Aext_patient_loc_norm',
        'tbp_lv_B_patient_loc_norm',
        'tbp_lv_Bext_patient_loc_norm',
        'tbp_lv_C_patient_loc_norm',
        'tbp_lv_Cext_patient_loc_norm',
        'tbp_lv_H_patient_loc_norm',
        'tbp_lv_Hext_patient_loc_norm',
        'tbp_lv_L_patient_loc_norm',
        'tbp_lv_Lext_patient_loc_norm',
        'tbp_lv_areaMM2_patient_loc_norm',
        'tbp_lv_area_perim_ratio_patient_loc_norm',
        'tbp_lv_color_std_mean_patient_loc_norm',
        'tbp_lv_deltaA_patient_loc_norm',
        'tbp_lv_deltaB_patient_loc_norm',
        'tbp_lv_deltaL_patient_loc_norm',
        'tbp_lv_deltaLB_patient_loc_norm',
        'tbp_lv_deltaLBnorm_patient_loc_norm',
        'tbp_lv_eccentricity_patient_loc_norm',
        'tbp_lv_minorAxisMM_patient_loc_norm',
        'tbp_lv_norm_border_patient_loc_norm',
        'tbp_lv_perimeterMM_patient_loc_norm',
        'tbp_lv_radial_color_std_max_patient_loc_norm',
        'tbp_lv_stdL_patient_loc_norm',
        'tbp_lv_stdLExt_patient_loc_norm',
        'tbp_lv_x_patient_loc_norm',
        'tbp_lv_y_patient_loc_norm',
        'tbp_lv_z_patient_loc_norm',
        'age_approx_patient_locsim_norm',
        'clin_size_long_diam_mm_patient_locsim_norm',
        'tbp_lv_A_patient_locsim_norm',
        'tbp_lv_Aext_patient_locsim_norm',
        'tbp_lv_B_patient_locsim_norm',
        'tbp_lv_Bext_patient_locsim_norm',
        'tbp_lv_C_patient_locsim_norm',
        'tbp_lv_Cext_patient_locsim_norm',
        'tbp_lv_H_patient_locsim_norm',
        'tbp_lv_Hext_patient_locsim_norm',
        'tbp_lv_L_patient_locsim_norm',
        'tbp_lv_Lext_patient_locsim_norm',
        'tbp_lv_areaMM2_patient_locsim_norm',
        'tbp_lv_area_perim_ratio_patient_locsim_norm',
        'tbp_lv_color_std_mean_patient_locsim_norm',
        'tbp_lv_deltaA_patient_locsim_norm',
        'tbp_lv_deltaB_patient_locsim_norm',
        'tbp_lv_deltaL_patient_locsim_norm',
        'tbp_lv_deltaLB_patient_locsim_norm',
        'tbp_lv_deltaLBnorm_patient_locsim_norm',
        'tbp_lv_eccentricity_patient_locsim_norm',
        'tbp_lv_minorAxisMM_patient_locsim_norm',
        'tbp_lv_norm_border_patient_locsim_norm',
        'tbp_lv_perimeterMM_patient_locsim_norm',
        'tbp_lv_radial_color_std_max_patient_locsim_norm',
        'tbp_lv_stdL_patient_locsim_norm',
        'tbp_lv_stdLExt_patient_locsim_norm',
        'tbp_lv_x_patient_locsim_norm',
        'tbp_lv_y_patient_locsim_norm',
        'tbp_lv_z_patient_locsim_norm',
        'age_approx_patient_attr_norm',
        'clin_size_long_diam_mm_patient_attr_norm',
        'tbp_lv_A_patient_attr_norm',
        'tbp_lv_Aext_patient_attr_norm',
        'tbp_lv_B_patient_attr_norm',
        'tbp_lv_Bext_patient_attr_norm',
        'tbp_lv_C_patient_attr_norm',
        'tbp_lv_Cext_patient_attr_norm',
        'tbp_lv_H_patient_attr_norm',
        'tbp_lv_Hext_patient_attr_norm',
        'tbp_lv_L_patient_attr_norm',
        'tbp_lv_Lext_patient_attr_norm',
        'tbp_lv_areaMM2_patient_attr_norm',
        'tbp_lv_area_perim_ratio_patient_attr_norm',
        'tbp_lv_color_std_mean_patient_attr_norm',
        'tbp_lv_deltaA_patient_attr_norm',
        'tbp_lv_deltaB_patient_attr_norm',
        'tbp_lv_deltaL_patient_attr_norm',
        'tbp_lv_deltaLB_patient_attr_norm',
        'tbp_lv_deltaLBnorm_patient_attr_norm',
        'tbp_lv_eccentricity_patient_attr_norm',
        'tbp_lv_minorAxisMM_patient_attr_norm',
        'tbp_lv_norm_border_patient_attr_norm',
        'tbp_lv_perimeterMM_patient_attr_norm',
        'tbp_lv_radial_color_std_max_patient_attr_norm',
        'tbp_lv_stdL_patient_attr_norm',
        'tbp_lv_stdLExt_patient_attr_norm',
        'tbp_lv_x_patient_attr_norm',
        'tbp_lv_y_patient_attr_norm',
        'tbp_lv_z_patient_attr_norm',
        'count_per_patient',
        'count_per_patient_ttype',
        'count_per_patient_loc',
        'count_per_patient_locsim',
        'count_per_patient_attr',
        'tbp_tile_type_3D__white',
        'tbp_tile_type_3D__XP',
        'tbp_lv_location_Right_Leg___Upper',
        'tbp_lv_location_Head___Neck',
        'tbp_lv_location_Torso_Back_Top_Third',
        'tbp_lv_location_Torso_Front_Top_Half',
        'tbp_lv_location_Right_Arm___Upper',
        'tbp_lv_location_Left_Leg___Upper',
        'tbp_lv_location_Torso_Front_Bottom_Half',
        'tbp_lv_location_Left_Arm___Upper',
        'tbp_lv_location_Right_Leg',
        'tbp_lv_location_Torso_Back_Middle_Third',
        'tbp_lv_location_Right_Arm___Lower',
        'tbp_lv_location_Right_Leg___Lower',
        'tbp_lv_location_Left_Leg___Lower',
        'tbp_lv_location_Left_Arm___Lower',
        'tbp_lv_location_Unknown',
        'tbp_lv_location_Left_Leg',
        'tbp_lv_location_Torso_Back_Bottom_Third',
        'tbp_lv_location_Left_Arm',
        'tbp_lv_location_Right_Arm',
        'tbp_lv_location_Torso_Front',
        'tbp_lv_location_Torso_Back',
        'tbp_lv_location_simple_Right_Leg',
        'tbp_lv_location_simple_Head___Neck',
        'tbp_lv_location_simple_Torso_Back',
        'tbp_lv_location_simple_Torso_Front',
        'tbp_lv_location_simple_Right_Arm',
        'tbp_lv_location_simple_Left_Leg',
        'tbp_lv_location_simple_Left_Arm',
        'tbp_lv_location_simple_Unknown',
        'attribution_Memorial_Sloan_Kettering_Cancer_Center',
        'attribution_ACEMID_MIA',
        'attribution_Department_of_Dermatology__Hospital_Clínic_de_Barcelona',
        'attribution_University_Hospital_of_Basel',
        'attribution_Frazer_Institute__The_University_of_Queensland__Dermatology_Research_Centre',
        'attribution_Department_of_Dermatology__University_of_Athens__Andreas_Syggros_Hospital_of_Skin_and_Venereal_Diseases__Alexander_Stratigos__Konstantinos_Liopyris',
        'attribution_ViDIR_Group__Department_of_Dermatology__Medical_University_of_Vienna',
        'combined_anatomical_site_lower_extremity_Right_Leg___Upper',
        'combined_anatomical_site_head_neck_Head___Neck',
        'combined_anatomical_site_posterior_torso_Torso_Back_Top_Third',
        'combined_anatomical_site_anterior_torso_Torso_Front_Top_Half',
        'combined_anatomical_site_upper_extremity_Right_Arm___Upper',
        'combined_anatomical_site_lower_extremity_Left_Leg___Upper',
        'combined_anatomical_site_anterior_torso_Torso_Front_Bottom_Half',
        'combined_anatomical_site_upper_extremity_Left_Arm___Upper',
        'combined_anatomical_site_lower_extremity_Right_Leg',
        'combined_anatomical_site_posterior_torso_Torso_Back_Middle_Third',
        'combined_anatomical_site_upper_extremity_Right_Arm___Lower',
        'combined_anatomical_site_lower_extremity_Right_Leg___Lower',
        'combined_anatomical_site_lower_extremity_Left_Leg___Lower',
        'combined_anatomical_site_upper_extremity_Left_Arm___Lower',
        'combined_anatomical_site__Unknown',
        'combined_anatomical_site_lower_extremity_Left_Leg',
        'combined_anatomical_site_posterior_torso_Torso_Back_Bottom_Third',
        'combined_anatomical_site_upper_extremity_Left_Arm',
        'combined_anatomical_site_upper_extremity_Right_Arm',
        'combined_anatomical_site_anterior_torso_Torso_Front',
        'combined_anatomical_site_posterior_torso_Torso_Back',
    ]
    BS_PRED = 20_000